<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.27">
    <title>安子的博客</title><meta name="description" content="Just playing around">
    <link rel="preload" href="/assets/js/runtime~app.892bb2af.js" as="script"><link rel="preload" href="/assets/css/styles.b8f66f08.css" as="style"><link rel="preload" href="/assets/js/812.9e9966eb.js" as="script"><link rel="preload" href="/assets/js/app.59477691.js" as="script">
    <link rel="stylesheet" href="/assets/css/styles.b8f66f08.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">安子的博客</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item"></p><ul class=""><li><!--[--><a aria-current="page" href="/web/webSocket/%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E6%A1%88%EF%BC%9ASSE%E3%80%81WebSoket.html#作者-放荡不羁的bug" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="作者：放荡不羁的bug"><!--[--><!--]--> 作者：放荡不羁的bug <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/web/webSocket/%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E6%A1%88%EF%BC%9ASSE%E3%80%81WebSoket.html#前述" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="前述"><!--[--><!--]--> 前述 <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/web/webSocket/%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E6%A1%88%EF%BC%9ASSE%E3%80%81WebSoket.html#技术介绍" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="技术介绍"><!--[--><!--]--> 技术介绍 <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/web/webSocket/%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E6%A1%88%EF%BC%9ASSE%E3%80%81WebSoket.html#websoket" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="WebSoket"><!--[--><!--]--> WebSoket <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/web/webSocket/%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E6%A1%88%EF%BC%9ASSE%E3%80%81WebSoket.html#sse" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="SSE"><!--[--><!--]--> SSE <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/web/webSocket/%E5%8A%A8%E6%80%81%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96%E6%96%B9%E6%A1%88%EF%BC%9ASSE%E3%80%81WebSoket.html#结论" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="结论"><!--[--><!--]--> 结论 <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h3 id="作者-放荡不羁的bug" tabindex="-1"><a class="header-anchor" href="#作者-放荡不羁的bug" aria-hidden="true">#</a> 作者：放荡不羁的bug</h3><h2 id="前述" tabindex="-1"><a class="header-anchor" href="#前述" aria-hidden="true">#</a> 前述</h2><p>在项目需求中，我们常常能够遇到需要实时获取状态的需求，例如获取某某任务是否完成状态，或者当其他用户做出操作时，界面需要实时提醒，这些需求通常需要我们实时地从后台取得当前状态，但由于 <code>HTTP</code> 请求是单向的（只能由客户端发起），所以通常使用轮询的方式去获取最新状态，这样的获取方式需要一直发送请求，无端增大浏览器与服务器性能消耗，明显不是很好的解决方案，本文将会介绍通过介绍及简单实现 <code>SSE</code>及 <code>WebSoket</code> 两种方案介绍非轮询式动态数据获取方案。</p><h2 id="技术介绍" tabindex="-1"><a class="header-anchor" href="#技术介绍" aria-hidden="true">#</a> 技术介绍</h2><h3 id="websoket" tabindex="-1"><a class="header-anchor" href="#websoket" aria-hidden="true">#</a> WebSoket</h3><p><code>WebSoket</code> 是前端比较常见的技术，其通过独立端口与服务器连接，实现服务器与客户端全双工通信，能够更好的节省服务器资源及带宽，连接时客户端主动发起 <code>WebSoket</code> 连接请求，连接后服务器与客户端可双向通信，如想关闭连接，客户端也可发送连接主动关闭请求，当前 <code>node</code> 实现 <code>WebSoket</code> 工具有很多，例如：<code>WebSocket-Node</code> 、<code>faye-websocket-node</code> 、<code>socket.io</code> ，接下来我将会使用<code>socket.io</code> 实现 <code>WebSoket</code> 后端推送及前后端交互，通过实现一个简单的实时交流页面展示 <code>WebSoket</code> 双向通信特性。</p><h4 id="准备" tabindex="-1"><a class="header-anchor" href="#准备" aria-hidden="true">#</a> 准备</h4><p>首先我们需要构建后端框架，在这里我使用的是 <code>Express</code> ，大家可以自己参照 <a href="https://www.expressjs.com.cn/" target="_blank" rel="noopener noreferrer">Express官网<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a> 构建框架，也可以跟着下面的指令构建。</p><p>创建项目文件夹，叫什么随意，我取名为 <code>websoketNode</code></p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">mkdir</span> websoketNode
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>进入文件夹后执行项目初始化命令，配置项全部默认就行，创建结束后可看到文件夹内 <code>package.json</code> 文件</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> websoketNode
<span class="token function">npm</span> init
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>项目引入 <code>Express</code> ，使用脚手架生成 <code>Express</code> 骨架</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> express --save
npx express-generator
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>生成骨架可能会提示下载 <code>express-generator</code> 依赖，确认即可</p><p>构建完成后，生成目录架构如下所示：</p><p><img src="https://i.loli.net/2021/10/13/OKnfMJtHwuqkgho.png" alt="menu"></p><p><code>Express</code> 启动后默认访问地址为 <code>http://localhost:3000/</code> ，进入界面可见：</p><p><img src="https://i.loli.net/2021/10/13/rfVtlMWSzYeCcJP.png" alt="image-2021091016074609"></p><p>引入 <code>soket.io</code> 依赖</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> socket.io
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>打开 <code>index.js</code> 文件，创建服务，引入 <code>socket.io</code> ，监听端口为 <code>3001</code> ，添加 <code>socket</code> 监听及允许请求跨域：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 创建soket</span>
<span class="token keyword">let</span> app <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;express&#39;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;http&#39;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">createServer</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> soket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;socket.io&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> io <span class="token operator">=</span> <span class="token function">soket</span><span class="token punctuation">(</span>server<span class="token punctuation">,</span> <span class="token punctuation">{</span> cors<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// socket相关监听都要放在这个回调里</span>
io<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;connection&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a user connected&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 断开连接时打印</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;disconnect&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a user go out&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 每隔3秒钟发送一次信息</span>
    <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;data: &quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span><span class="token string">&#39;来自Soket后端的推送&#39;</span> <span class="token operator">+</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 接收信息，并返回所发送的消息</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token string">&#39;你发送了信息：&#39;</span> <span class="token operator">+</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">//开启端口监听socket</span>
server<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3001</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p>这样 <code>WebSoket</code> 后端逻辑就完成了，<code>WebSoket</code> 每三秒钟发送一次信息，在接收前端发送的消息后，将消息返回至前端</p><p>前端框架就不详细描述了，大家可以参照官网去搭建，接下来我们开始实现前端的 <code>WebSoket</code> 连接</p><p>首先引入 <code>socket.io</code> 包：</p><div class="language-bash ext-sh line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> socket.io-client --save
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>界面引入 <code>socket.io</code> ，创建 <code>WebSoket</code> 连接，将后端发送内容拼接后展示（注：界面销毁时需要将连接关闭，后端无法自动销毁）：</p><p>连接 <code>WebSoket</code> 代码：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">let</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">&#39;ws://127.0.0.1:3001&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 建立链接</span>
<span class="token comment">// 监听服务端的消息“msg”</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    that<span class="token punctuation">.</span>showContent <span class="token operator">=</span> that<span class="token punctuation">.</span>showContent <span class="token operator">+</span> <span class="token string">&#39;\n&#39;</span> <span class="token operator">+</span> data
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>web</code> 代码：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>show-body<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>show-pre<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ showContent }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>启动前后端，进入界面即可获取到后端三秒传过来的时间信息：</p><p><img src="https://i.loli.net/2021/10/13/L5HSJvEi6jGsA39.png" alt="image-2021092614135448"></p><p>此时 <code>WebSoket</code> 已连接，接下来我们使用它完成一个聊天室</p><p>首先，我们在前端框架内引入 <code>element</code> 框架，引用流程请见 <a href="https://element.eleme.cn/#/zh-CN/component/quickstart" target="_blank" rel="noopener noreferrer">element官网<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p>通过样式组件，我们优化我们的聊天室：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-card</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box-card<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clearfix<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>聊天室<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 3px 0</span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>退出聊天<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in messageList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.key<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.type === <span class="token punctuation">&#39;</span>sendMessage<span class="token punctuation">&#39;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image-left<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name-image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name | nameFilter }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name }}：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>success<span class="token punctuation">&quot;</span></span> <span class="token attr-name">effect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>plain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.type === <span class="token punctuation">&#39;</span>tip<span class="token punctuation">&#39;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tip<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name }} 已进入群聊<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">clear</span><span class="token punctuation">:</span>both</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-row</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button-container<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:gutter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>21<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>keyup.enter.native</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendMessage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入内容<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendMessage<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>发送<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-row</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-card</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
    <span class="token selector">.container</span> <span class="token punctuation">{</span>
        <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
        <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
        <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 39%<span class="token punctuation">;</span>
        <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
        <span class="token selector">.message-container</span> <span class="token punctuation">{</span>
            <span class="token property">height</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
            <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
            <span class="token selector">.message-item</span> <span class="token punctuation">{</span>
                <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
                <span class="token property">width</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>
                <span class="token property">margin</span><span class="token punctuation">:</span> 4px 0px<span class="token punctuation">;</span>
                <span class="token selector">.image-left</span> <span class="token punctuation">{</span>
                    <span class="token property">flex</span><span class="token punctuation">:</span> 0 40px<span class="token punctuation">;</span>
                    <span class="token selector">.name-image</span> <span class="token punctuation">{</span>
                        <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
                        <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
                        <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
                        <span class="token property">background-color</span><span class="token punctuation">:</span> #037df3<span class="token punctuation">;</span>
                        <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
                        <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
                        <span class="token property">line-height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
                        <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token selector">.text-right</span> <span class="token punctuation">{</span>
                    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
                    <span class="token selector">.name</span> <span class="token punctuation">{</span>
                        <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
                        <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token selector">.text</span> <span class="token punctuation">{</span>
                        <span class="token property">color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token selector">.my-message</span> <span class="token punctuation">{</span>
                <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
                <span class="token property">flex-direction</span><span class="token punctuation">:</span> row-reverse<span class="token punctuation">;</span>
                <span class="token property">padding-right</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
                <span class="token selector">.image-left</span> <span class="token punctuation">{</span>
                    <span class="token selector">.name-image</span> <span class="token punctuation">{</span>
                        <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
                <span class="token selector">.text-right</span> <span class="token punctuation">{</span>
                    <span class="token selector">.name</span> <span class="token punctuation">{</span>
                        <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token selector">.text</span> <span class="token punctuation">{</span>
                        <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token selector">.tip</span> <span class="token punctuation">{</span>
                <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
                <span class="token property">margin</span><span class="token punctuation">:</span> 4px 0px<span class="token punctuation">;</span>
                <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
                <span class="token property">color</span><span class="token punctuation">:</span> #BDBDBD<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.button-container</span> <span class="token punctuation">{</span>
            <span class="token property">margin-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token selector">::-webkit-scrollbar</span> <span class="token punctuation">{</span>
            <span class="token property">width</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token comment">/*对垂直流动条有效*/</span>
            <span class="token property">height</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token comment">/*对水平流动条有效*/</span>
        <span class="token punctuation">}</span>
        <span class="token comment">/*定义滑块颜色、内阴影及圆角*/</span>
        <span class="token selector">::-webkit-scrollbar-thumb</span><span class="token punctuation">{</span>
            <span class="token property">border-radius</span><span class="token punctuation">:</span> 7px<span class="token punctuation">;</span>
            <span class="token property">-webkit-box-shadow</span><span class="token punctuation">:</span> inset 0 0 6px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span>0<span class="token punctuation">,</span>0<span class="token punctuation">,</span>.3<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token property">background-color</span><span class="token punctuation">:</span> #E8E8E8<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br></div></div><p>此时我们得到的界面如下：</p><p><img src="https://i.loli.net/2021/10/13/QHufBrbM9OlPoRL.png" alt="image-2021100818534093"></p><p>在进入界面时，我们需要自定义创建一个姓名，创建方法网上可以找到很多，后面代码中也会给出。</p><p>我们在 <code>mounted</code> 时调用生成名字：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>myName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRandomName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><p>当我们进入聊天室的时候，需要向所有人发送一个进入的提示，为了与信息做区分，我们定义消息类型为 <code>tip</code> ，代码如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;connect&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token punctuation">{</span>
        key<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        name<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myName<span class="token punctuation">,</span>
        type<span class="token operator">:</span> <span class="token string">&#39;tip&#39;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>当然，此时后端信息接收及发送也需要修改，删除间隔的发送消息：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>io<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;connection&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;a user connected&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 断开连接时打印</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;disconnect&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;a user go out&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 每隔3秒钟发送一次信息</span>
    <span class="token comment">// setInterval(() =&gt; {</span>
    <span class="token comment">//   io.emit(&quot;msg&quot;, &quot;data: &quot; + (&#39;来自Soket后端的推送&#39; + new Date()));</span>
    <span class="token comment">// }, 3000);</span>

    <span class="token comment">// 接收信息</span>
    socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        io<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&quot;msg&quot;</span><span class="token punctuation">,</span> obj<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>而当我们发送消息时，也定义一个类型为 <code>sendMessage</code> 表示这是使用者发出的信息：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 发送信息</span>
<span class="token function">sendMessage</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">!==</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token punctuation">{</span>
            key<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            name<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myName<span class="token punctuation">,</span>
            message<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">,</span>
            type<span class="token operator">:</span> <span class="token string">&#39;sendMessage&#39;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>当我们接收到消息时，只需要将接收到的数据推入消息列表中，界面根据类型渲染即可：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 监听服务端的消息“msg”</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>messageList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>完成后代码如下：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-card</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box-card<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">slot</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clearfix<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span>聊天室<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span> <span class="token property">padding</span><span class="token punctuation">:</span> 3px 0</span><span class="token punctuation">&quot;</span></span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>退出聊天<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msg<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in messageList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.key<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.type === <span class="token punctuation">&#39;</span>sendMessage<span class="token punctuation">&#39;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image-left<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name-image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name | nameFilter }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name }}：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
              <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>success<span class="token punctuation">&quot;</span></span> <span class="token attr-name">effect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>plain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.type === <span class="token punctuation">&#39;</span>tip<span class="token punctuation">&#39;</span><span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tip<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name }} 已进入群聊<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">clear</span><span class="token punctuation">:</span>both</span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-row</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>button-container<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:gutter</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>21<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-input</span> <span class="token attr-name">v-model</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">v-on:</span>keyup.enter.native</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendMessage<span class="token punctuation">&quot;</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>请输入内容<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-input</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-col</span> <span class="token attr-name">:span</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>3<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sendMessage<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>发送<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-button</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-col</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-row</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-card</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> io <span class="token keyword">from</span> <span class="token string">&#39;socket.io-client&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;WebSocket&#39;</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      socket<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token comment">// soket连接实例</span>
      myName<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 我的名字</span>
      message<span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 发送信息</span>
      messageList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 信息列表</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  filters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">nameFilter</span> <span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> name<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>name<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>myName <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getRandomName</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">connectSoket</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 连接soket接收信息</span>
    <span class="token function">connectSoket</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token string">&#39;ws://127.0.0.1:3001&#39;</span><span class="token punctuation">)</span> <span class="token comment">// 建立链接</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;connect&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token punctuation">{</span>
          key<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myName<span class="token punctuation">,</span>
          type<span class="token operator">:</span> <span class="token string">&#39;tip&#39;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 监听服务端的消息“msg”</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>messageList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 发送信息</span>
    <span class="token function">sendMessage</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">!==</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">let</span> param <span class="token operator">=</span> <span class="token punctuation">{</span>
          key<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
          name<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myName<span class="token punctuation">,</span>
          message<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">,</span>
          type<span class="token operator">:</span> <span class="token string">&#39;sendMessage&#39;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">emit</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 获取随机姓名</span>
    <span class="token function">getRandomName</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> firstNames <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;赵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;钱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;孙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;李&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;周&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;吴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;王&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;陈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;楮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;卫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蒋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;沈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;韩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;杨&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;朱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;秦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;许&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;何&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;吕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;施&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;张&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;孔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;曹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;严&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;华&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;金&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;魏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;陶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姜&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;戚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;谢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;喻&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;柏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;水&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;窦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;章&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;云&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;苏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;潘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;葛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;奚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;范&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;彭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郎&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;鲁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;韦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;马&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;苗&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;花&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;方&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;任&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;袁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;柳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;酆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鲍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;史&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;唐&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;费&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;廉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;岑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;薛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;贺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;倪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;汤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;滕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;殷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;罗&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;毕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;安&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;常&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;乐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;于&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;时&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;傅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;皮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;卞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;齐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;康&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;伍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;余&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;元&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;卜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;顾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;孟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;平&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;黄&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;和&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;穆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;萧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;湛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;汪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;祁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;毛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;禹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;狄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;米&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;贝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;明&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;臧&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;计&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;伏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;成&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;戴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;谈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;茅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;庞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;熊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;纪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;舒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;屈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;项&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;祝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;董&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梁&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;杜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蓝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;闽&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;席&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;季&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;麻&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;强&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;贾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;路&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;娄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;危&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;江&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;童&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郭&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;梅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;盛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;林&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;刁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;锺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;徐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;丘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;骆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;高&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蔡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;田&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;樊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;胡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;霍&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;虞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;万&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;支&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;柯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;管&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;卢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;莫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;经&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;房&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;裘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;缪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;干&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;解&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;应&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宗&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;丁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;贲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邓&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;单&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;杭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;洪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;包&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诸&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;左&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;石&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;崔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;吉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;钮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;龚&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;程&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;嵇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;滑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;裴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;陆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;荣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;荀&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;於&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;惠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;甄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;麹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;家&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;封&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;芮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;储&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;靳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;汲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;糜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;松&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;井&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;段&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;富&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;巫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;乌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;焦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;巴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;弓&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;牧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;隗&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;山&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;谷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;车&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;侯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宓&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蓬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;全&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郗&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;班&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;仰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;秋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;仲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;伊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宫&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;宁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;仇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;栾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;暴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;甘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;斜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;厉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;戎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;祖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;武&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;符&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;刘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;景&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;詹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;束&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;龙&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;叶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;幸&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;司&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;韶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;黎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蓟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;薄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;印&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;白&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;怀&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蒲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;邰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;从&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鄂&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;索&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;咸&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;籍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;赖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;卓&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蔺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;屠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蒙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;池&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;乔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;胥&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;能&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;苍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;双&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;闻&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;莘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;党&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;谭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;贡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;劳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;逄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;姬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;申&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;扶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;堵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雍&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;郤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;璩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;桑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;桂&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;濮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;牛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;寿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;通&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;边&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;扈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;燕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冀&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;郏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;农&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;温&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;别&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;庄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;柴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;瞿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;充&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;慕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;连&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;茹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;习&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;艾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鱼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;容&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;向&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;古&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;易&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;慎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;戈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;廖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;庾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;终&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;暨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;居&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;衡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;步&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;都&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;耿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;满&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;弘&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;匡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;国&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;文&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;寇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;广&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;禄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;东&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;殳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;沃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;利&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蔚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;越&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;隆&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;师&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;巩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;厍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;聂&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;勾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;敖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;融&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;訾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;辛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;那&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;简&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;饶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;空&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;曾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;毋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;沙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;乜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;养&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鞠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;须&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;丰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;巢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;关&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蒯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;相&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;查&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;后&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;荆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;红&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;游&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;竺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;权&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;逑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;盖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;益&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;桓&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;仉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;督&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;楚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;法&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;汝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鄢&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;涂&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;钦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;岳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;帅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;缑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;亢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;况&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;后&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;有&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;琴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;归&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;海&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;墨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;哈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;谯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;笪&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;年&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;爱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;商&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;牟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;伯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;赏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;万俟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;司马&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;上官&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欧阳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夏侯&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;诸葛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;闻人&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;东方&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;赫连&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;皇甫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尉迟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公羊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;澹台&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公冶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宗政&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;濮阳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淳于&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;单于&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;太叔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;申屠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公孙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;仲孙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;轩辕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;令狐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;锺离&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇文&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;长孙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;慕容&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鲜于&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;闾丘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;司徒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;司空&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;丌官&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;司寇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;子车&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;微生&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颛孙&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;端木&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;巫马&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公西&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;漆雕&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;乐正&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;壤驷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;公良&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;拓拔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夹谷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宰父&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;谷梁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;段干&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;百里&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;东郭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;南门&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;呼延&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;羊舌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梁丘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;左丘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;东门&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;西门&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;南宫&#39;</span>
      <span class="token punctuation">]</span>

      <span class="token keyword">var</span> lastNames <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">&#39;子璇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;国栋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夫子&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;瑞堂&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;甜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;敏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;国贤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;贺祥&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨涛&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;昊轩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;易轩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;益辰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;益帆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;益冉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;瑾春&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;瑾昆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;春齐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;杨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;文昊&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;东东&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雄霖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩晨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;熙涵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;溶溶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冰枫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣欣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宜豪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣慧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;建政&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;美欣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淑慧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;文轩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;文杰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣源&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;忠林&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;榕润&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣汝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;慧嘉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;新建&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;建林&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;亦菲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;林&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冰洁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳欣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵涵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;禹辰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淳美&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泽惠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;伟洋&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;涵越&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;润丽&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淑华&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晶莹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凌晶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;苒溪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雨涵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;嘉怡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳毅&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;子辰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳琪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;紫轩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;瑞辰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昕蕊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;萌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;明远&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣宜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泽远&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣怡&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;佳怡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳惠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨茜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨璐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;运昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;汝鑫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淑君&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晶滢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;润莎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;榕汕&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;佳钰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳玉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晓庆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;一鸣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;语晨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;添池&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;添昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雨泽&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雅晗&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雅涵&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;清妍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诗悦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;嘉乐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨涵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;天赫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;玥傲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;天昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;萌萌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;若萌&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;秋白&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;南风&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;醉山&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;初彤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凝海&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;紫文&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凌晴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;香卉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雅琴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;傲安&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;傲之&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;初蝶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;寻桃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;代芹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诗霜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;春柏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;绿夏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;碧灵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诗柳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夏柳&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;采白&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;慕梅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;乐安&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冬菱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;紫安&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宛凝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雨雪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;易真&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;安荷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;静竹&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;飞雪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雪兰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雅霜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;从蓉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冷雪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;靖巧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翠丝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;觅翠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凡白&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;乐蓉&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;迎波&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;丹烟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梦旋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;书双&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;念桃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夜天&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;海桃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;青香&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;恨风&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;安筠&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;觅柔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;初南&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;秋蝶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;千易&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;安露&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诗蕊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;山雁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;友菱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;香露&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晓兰&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;涵瑶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;秋柔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;思菱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;醉柳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;以寒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;迎夏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;向雪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;香莲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;以丹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;依凝&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;如柏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雁菱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凝竹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宛白&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;初柔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;南蕾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;书萱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梦槐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;香芹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;南琴&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;绿海&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;沛儿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晓瑶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;听春&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;易巧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;念云&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晓灵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;静枫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夏蓉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;如南&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;幼丝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;秋白&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冰安&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凝蝶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;紫雪&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;念双&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;念真&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;曼寒&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凡霜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;白卉&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;语山&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冷珍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;秋翠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;夏柳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;如之&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;忆南&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;书易&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翠桃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;寄瑶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;如曼&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;问柳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;香梅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;幻桃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;又菡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;春绿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;醉蝶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;亦绿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诗珊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;听芹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;新之&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;博瀚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;博超&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;才哲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;才俊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;成和&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;成弘&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊苍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊空&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊乾&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;昊然&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊然&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊天&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊焱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊英&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩波&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩博&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩初&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩大&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩宕&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;浩荡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩歌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩广&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩涆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩瀚&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩浩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩慨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩旷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩阔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩漫&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;浩淼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩渺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩邈&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩气&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩然&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩穰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩壤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩思&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩言&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;皓轩&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;和蔼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;和安&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;和昶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翔东&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊伟&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;楚桥&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;智霖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩杰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;炎承&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;思哲&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;璟新&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;楚怀&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;继智&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昭旺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊泽&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;子中&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羽睿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;嘉雷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鸿翔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;明轩&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;棋齐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;轶乐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昭易&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;臻翔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泽鑫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;芮军&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩奕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宏明&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;忠贤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;锦辉&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;元毅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;霈胜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇峻&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;子博&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;语霖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;胜佑&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊涛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩淇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;乐航&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泽楷&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;嘉宁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;敬宣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;韦宁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;建新&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇怀&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;皓玄&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冠捷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊铭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;一鸣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;堂耀&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;轩凝&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;舰曦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;跃鑫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梓杰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;筱宇&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;弘涛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羿天&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;广嘉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;陆铭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;志卿&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;连彬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;景智&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;孟昕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羿然&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;文渊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羿楦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晗昱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晗日&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵畅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵涤&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;昊穹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵亮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵忍&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵容&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊可&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;智鹏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;诚钰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;书墨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊易&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩渺&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;宸水&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;嘉许&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;时贤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;飞腾&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;沂晨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;殿斌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;霄鸿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;辰略&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;澜鸿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;景博&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;咨涵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;修德&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;景辉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;语旋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;智逸&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鸿锋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;思梵&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;弈煊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泰河&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;逞宇&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;嘉颢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;锦沅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颢焱&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;萧彬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;悦升&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;香音&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;烨柠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颢咏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;仁贤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尚然&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;羿鳞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;月鸿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;健霖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鸿昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;竣杰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;可顺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;炯乐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊彦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;海沧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;捷明&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;飞扬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;杰辰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羽捷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;曦晴&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;裕鸿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;翌锦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;沐宸&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;福同&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;旻驰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;龙宁&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;文虹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;义凡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;广晨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宸滔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;嘉岐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;雅珺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;睿明&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;皓轩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;程天&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;子酝&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;艾康&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;如羽&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冠玉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;子歉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;永昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;龙华&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;兆颜&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;奇文&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;月昕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;裕锦&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;昂佳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊浩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇韬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;睿焓&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;永译&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鸿彬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颢霖&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;益彬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;虹昊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;飞悦&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;睿珏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;?宵童&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;睿鸿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;容冰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;逸濠&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;楷岩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;弘义&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;海萦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊孺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梓铭&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;生钊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蓝玺&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨辕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇菡&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;砚海&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;文揩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;韬瑞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;彦红&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;奕韦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;清予&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;宁翼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;冬睿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;锦昌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;烨宁&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昌权&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;国研&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;德运&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;孝清&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;佳阳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;凯玮&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;正真&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;民云&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昕冶&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;力威&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;帅欣&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;知淳&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;烨飞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;兴远&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;子墨&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;澄欣&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;烨煊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;悦勤&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨津&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;博宏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;育萌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羽炫&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;绍钧&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;睿昌&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泓千&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颢炜&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;虹金&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;筠航&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;元甲&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;星明&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;景涛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;铭虹&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;德本&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;向辉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;基翔&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;家易&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;欣鹏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羽荃&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;泽容&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;弘亮&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;尚廷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;轩梓&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;甫津&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;彬楷&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;寅飞&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;愉君&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;阳平&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;誉杰&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;钦昭&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;蕴藉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;羽程&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宏海&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;涵畅&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;光浩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;令沂&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩浩&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;睿锦&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;易泽&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;俊康&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;家文&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;晨元&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;语洋&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;裕宏&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梓榛&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;阳嘉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;恒展&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;雨远&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;哲伊&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;逸江&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;丰源&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;学东&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;奇岩&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;浩财&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;和蔼&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;红言&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;瑞赫&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;森圆&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;欣赢&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;梓鸿&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;博明&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;铭育&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;颢硕&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇烯&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;宇如&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;淳炎&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;源承&#39;</span><span class="token punctuation">,</span>
        <span class="token string">&#39;斌彬&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;飞沉&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;鸿璐&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;昊弘&#39;</span>
      <span class="token punctuation">]</span>

      lastNames <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">removeDup</span><span class="token punctuation">(</span>lastNames<span class="token punctuation">)</span>

      <span class="token keyword">var</span> firstLength <span class="token operator">=</span> firstNames<span class="token punctuation">.</span>length
      <span class="token keyword">var</span> lastLength <span class="token operator">=</span> lastNames<span class="token punctuation">.</span>length

      <span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> firstLength<span class="token punctuation">)</span>
      <span class="token keyword">var</span> j <span class="token operator">=</span> <span class="token function">parseInt</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> lastLength<span class="token punctuation">)</span>
      <span class="token keyword">var</span> name <span class="token operator">=</span> firstNames<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> lastNames<span class="token punctuation">[</span>j<span class="token punctuation">]</span>

      <span class="token keyword">return</span> name
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// 去重</span>
    <span class="token function">removeDup</span> <span class="token punctuation">(</span><span class="token parameter">names</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      <span class="token keyword">var</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> names<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>obj<span class="token punctuation">[</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
          obj<span class="token punctuation">[</span>names<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">1</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>

      <span class="token keyword">return</span> result
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">destroyed</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.container</span> <span class="token punctuation">{</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 39%<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
  <span class="token selector">.message-container</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 500px<span class="token punctuation">;</span>
    <span class="token property">overflow</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
    <span class="token selector">.message-item</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 80%<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 4px 0px<span class="token punctuation">;</span>
      <span class="token selector">.image-left</span> <span class="token punctuation">{</span>
        <span class="token property">flex</span><span class="token punctuation">:</span> 0 40px<span class="token punctuation">;</span>
        <span class="token selector">.name-image</span> <span class="token punctuation">{</span>
          <span class="token property">width</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
          <span class="token property">height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
          <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
          <span class="token property">background-color</span><span class="token punctuation">:</span> #037df3<span class="token punctuation">;</span>
          <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>
          <span class="token property">font-size</span><span class="token punctuation">:</span> 12px<span class="token punctuation">;</span>
          <span class="token property">line-height</span><span class="token punctuation">:</span> 30px<span class="token punctuation">;</span>
          <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.text-right</span> <span class="token punctuation">{</span>
        <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
        <span class="token selector">.name</span> <span class="token punctuation">{</span>
          <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
          <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 3px<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.text</span> <span class="token punctuation">{</span>
          <span class="token property">color</span><span class="token punctuation">:</span> #000<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.my-message</span> <span class="token punctuation">{</span>
      <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
      <span class="token property">flex-direction</span><span class="token punctuation">:</span> row-reverse<span class="token punctuation">;</span>
      <span class="token property">padding-right</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
      <span class="token selector">.image-left</span> <span class="token punctuation">{</span>
        <span class="token selector">.name-image</span> <span class="token punctuation">{</span>
          <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.text-right</span> <span class="token punctuation">{</span>
        <span class="token selector">.name</span> <span class="token punctuation">{</span>
          <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token selector">.text</span> <span class="token punctuation">{</span>
          <span class="token property">float</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token selector">.tip</span> <span class="token punctuation">{</span>
      <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">margin</span><span class="token punctuation">:</span> 4px 0px<span class="token punctuation">;</span>
      <span class="token property">font-size</span><span class="token punctuation">:</span> 13px<span class="token punctuation">;</span>
      <span class="token property">color</span><span class="token punctuation">:</span> #BDBDBD<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.button-container</span> <span class="token punctuation">{</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">::-webkit-scrollbar</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token comment">/*对垂直流动条有效*/</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span> <span class="token comment">/*对水平流动条有效*/</span>
  <span class="token punctuation">}</span>
  <span class="token comment">/*定义滑块颜色、内阴影及圆角*/</span>
  <span class="token selector">::-webkit-scrollbar-thumb</span><span class="token punctuation">{</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 7px<span class="token punctuation">;</span>
    <span class="token property">-webkit-box-shadow</span><span class="token punctuation">:</span> inset 0 0 6px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span>0<span class="token punctuation">,</span>0<span class="token punctuation">,</span>.3<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #E8E8E8<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br><span class="line-number">180</span><br><span class="line-number">181</span><br><span class="line-number">182</span><br><span class="line-number">183</span><br><span class="line-number">184</span><br><span class="line-number">185</span><br><span class="line-number">186</span><br><span class="line-number">187</span><br><span class="line-number">188</span><br><span class="line-number">189</span><br><span class="line-number">190</span><br><span class="line-number">191</span><br><span class="line-number">192</span><br><span class="line-number">193</span><br><span class="line-number">194</span><br><span class="line-number">195</span><br><span class="line-number">196</span><br><span class="line-number">197</span><br><span class="line-number">198</span><br><span class="line-number">199</span><br><span class="line-number">200</span><br><span class="line-number">201</span><br><span class="line-number">202</span><br><span class="line-number">203</span><br><span class="line-number">204</span><br><span class="line-number">205</span><br><span class="line-number">206</span><br><span class="line-number">207</span><br><span class="line-number">208</span><br><span class="line-number">209</span><br><span class="line-number">210</span><br><span class="line-number">211</span><br><span class="line-number">212</span><br><span class="line-number">213</span><br><span class="line-number">214</span><br><span class="line-number">215</span><br><span class="line-number">216</span><br><span class="line-number">217</span><br><span class="line-number">218</span><br><span class="line-number">219</span><br><span class="line-number">220</span><br><span class="line-number">221</span><br><span class="line-number">222</span><br><span class="line-number">223</span><br><span class="line-number">224</span><br><span class="line-number">225</span><br><span class="line-number">226</span><br><span class="line-number">227</span><br><span class="line-number">228</span><br><span class="line-number">229</span><br><span class="line-number">230</span><br><span class="line-number">231</span><br><span class="line-number">232</span><br><span class="line-number">233</span><br><span class="line-number">234</span><br><span class="line-number">235</span><br><span class="line-number">236</span><br><span class="line-number">237</span><br><span class="line-number">238</span><br><span class="line-number">239</span><br><span class="line-number">240</span><br><span class="line-number">241</span><br><span class="line-number">242</span><br><span class="line-number">243</span><br><span class="line-number">244</span><br><span class="line-number">245</span><br><span class="line-number">246</span><br><span class="line-number">247</span><br><span class="line-number">248</span><br><span class="line-number">249</span><br><span class="line-number">250</span><br><span class="line-number">251</span><br><span class="line-number">252</span><br><span class="line-number">253</span><br><span class="line-number">254</span><br><span class="line-number">255</span><br><span class="line-number">256</span><br><span class="line-number">257</span><br><span class="line-number">258</span><br><span class="line-number">259</span><br><span class="line-number">260</span><br><span class="line-number">261</span><br><span class="line-number">262</span><br><span class="line-number">263</span><br><span class="line-number">264</span><br><span class="line-number">265</span><br><span class="line-number">266</span><br><span class="line-number">267</span><br><span class="line-number">268</span><br><span class="line-number">269</span><br><span class="line-number">270</span><br><span class="line-number">271</span><br><span class="line-number">272</span><br><span class="line-number">273</span><br><span class="line-number">274</span><br><span class="line-number">275</span><br><span class="line-number">276</span><br><span class="line-number">277</span><br><span class="line-number">278</span><br><span class="line-number">279</span><br><span class="line-number">280</span><br><span class="line-number">281</span><br><span class="line-number">282</span><br><span class="line-number">283</span><br><span class="line-number">284</span><br><span class="line-number">285</span><br><span class="line-number">286</span><br><span class="line-number">287</span><br><span class="line-number">288</span><br><span class="line-number">289</span><br><span class="line-number">290</span><br><span class="line-number">291</span><br><span class="line-number">292</span><br><span class="line-number">293</span><br><span class="line-number">294</span><br><span class="line-number">295</span><br></div></div><p>完成上述代码后，基本能够实现信息的发送与接收，后面我们对界面进行优化，我们主要优化点有两个：</p><ul><li>如何判断哪条信息是我发的，并且以不同方式展示出来</li><li>怎样才能让最新信息始终展示出来</li></ul><p>对于第一个点，我们采取姓名判断，我们定义两套样式，分别为 <code>message-item</code> (他人发送消息)与 <code>message-item my-message</code> (自己发送消息)，在 <code>html</code> 循环渲染的时候判断当前发送者名称或身份标识符与我是否相同，如果相同则使用 <code>message-item my-message</code> 样式渲染，代码如下：</p><p>web:</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.type === <span class="token punctuation">&#39;</span>sendMessage<span class="token punctuation">&#39;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">:class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>getMessageClass(item)<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image-left<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name-image<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name | nameFilter }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text-right<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.name }}：<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>el-tag</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text<span class="token punctuation">&quot;</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>success<span class="token punctuation">&quot;</span></span> <span class="token attr-name">effect</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>plain<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{ item.message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>el-tag</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>JavaScript:</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 设置信息样式</span>
<span class="token function">getMessageClass</span> <span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>item<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token keyword">this</span><span class="token punctuation">.</span>myName<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;message-item my-message&#39;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;message-item&#39;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>对于第二点，我们接收到新的信息的时候，主动将滚动条滚动到最低端即可，代码如下：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 监听服务端的消息“msg”</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>socket<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;msg&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>messageList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token comment">// 需要等待新信息渲染完成之后才能将设置滚动条位置</span>
    <span class="token function">requestAnimationFrame</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>msg<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>msg<span class="token punctuation">.</span>scrollHeight<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>到此，我们聊天室，算是完成了基本功能：</p><p><img src="https://i.loli.net/2021/10/13/4DZnzJgHcq9LvSu.png" alt="image-202110081924496"></p><p>在 <code>WebSoket</code> 中，没有任何事件标识符，那 <code>WebSoket</code> 怎样实现前后端多个事件交流呢？答案很简单，我们在客户端请求与服务端推送数据中添加事件标识，然后前后端约定标识统一即可，因此通过 <code>WebSoket</code> 实现多种事件交互模型如下：</p><p><img src="https://i.loli.net/2021/10/13/S7bWGLY2tF3DxaH.png" alt="WebSoket多事件处.png"></p><h3 id="sse" tabindex="-1"><a class="header-anchor" href="#sse" aria-hidden="true">#</a> SSE</h3><p><code>SSE</code> （ Server-sent Events ）是 <code>WebSocket</code> 的一种轻量代替方案，基于 HTTP 协议。</p><p>严格来说，HTTP协议只能由客户端发起请求，并且在请求结束后关闭连接，但是如果我们发起一个请求的时候，服务器告诉客户端我要发送一个流信息，则客户端连接就会一直打开，而 <code>SSE</code> 使用的就是这个原理。</p><p>如上所述，可见 <code>SSE</code> 只有服务器到客户端的单向交互，且较为轻量（相当于一个接口），因此我们可以用它实现一些后端消息推送的接收等等。</p><p>接下来，我们将使用 <code>SSE</code> 实现一个对系统资源使用状态监控的界面，以此进一步了解 <code>SSE</code> 的使用方式。</p><h4 id="准备-1" tabindex="-1"><a class="header-anchor" href="#准备-1" aria-hidden="true">#</a> 准备</h4><p>前后端代码暂时就再不新建一个项目了，我们还是使用原来的。</p><p>首先我们需要分析一下后端状态推送的需求，简单来说就是后端不断查询最新状态，然后返回给前端，那么我们什么时候查询呢，最开始的时候我将查询逻辑放置在接口中，然后发现这样的话我每连一次，都要多一套状态查询，如果连接数量级过大，服务器压力会骤增，所以后续将查询状态的方法放置在全局，每间隔一秒钟查询一次，接口中，每一秒钟项客户端发送一次，这样的话在保证数据实时的前提下，降低了服务器的查询次数。</p><p>完成了方案的设计，我们开始实现后端的检索及推送功能：</p><p>首先我们怎样获取服务器资源使用信息呢？</p><p><code>node</code> 给我们提供了便捷的 <code>api</code> : <code>os</code> , <code>os</code> 模块提供了与操作系统相关的实用方法和属性，我们可以通过其中方法获取当前系统多种属性。</p><p>我们在后端代码 <code>index.js</code> 中插入全局的服务器监听程序：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> os <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;os&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> serviceMessage <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 每隔1秒钟监听当前服务器情况</span>
<span class="token keyword">let</span> serviceInterval <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  serviceMessage <span class="token operator">=</span> <span class="token punctuation">{</span>
    free<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">freemem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 闲置内存</span>
    total<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">totalmem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 总内存</span>
    used<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">totalmem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> os<span class="token punctuation">.</span><span class="token function">freemem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 使用内存</span>
    usageRate<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>os<span class="token punctuation">.</span><span class="token function">totalmem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> os<span class="token punctuation">.</span><span class="token function">freemem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">/</span> os<span class="token punctuation">.</span><span class="token function">totalmem</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 内存使用率</span>
    platform<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">platform</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 平台</span>
    type<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">type</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 操作系统名称</span>
    runTime<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">uptime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 系统正常运行时间</span>
    <span class="token operator">...</span>os<span class="token punctuation">.</span><span class="token function">userInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>  <span class="token comment">// 当前有效用户的信息</span>
    cpuInfo<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">cpus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// CPU 内核的信息</span>
    hostName<span class="token operator">:</span> os<span class="token punctuation">.</span><span class="token function">hostname</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 操作系统的主机名</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>创建 <code>SSE</code> 接口：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&#39;/getServerMessage&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 声明接口类型为SSE</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token string">&quot;Content-Type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text/event-stream&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Cache-Control&quot;</span><span class="token operator">:</span> <span class="token string">&quot;no-cache&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;Connection&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keep-alive&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 间隔1秒钟向前端推送服务器信息</span>
  <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// 发送信息以 \n\n 截断，返回数据中必须携带，不然客户端认为当前一次事件未结束，会一直等待</span>
    <span class="token comment">// 请求前必须添加 data: ，否则前端无法接收</span>
    res<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token string">&quot;data:&quot;</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>serviceMessage<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>需要注意的是，我们每发一段消息的时候需要在后面加上 <code>\n\n</code> 字符，客户端通过该字符将流信息截断，如果不添加的话，客户端会认为本条信息未发送完成，导致接口访问后一直接收不到信息。</p><p>此时我们可以直接在浏览器输入地址：<code>localhost:3001/getServerMessage</code> 访问接口，访问结果如下：</p><p><img src="https://i.loli.net/2021/10/13/GuMVwJXo3tYHNmq.png" alt="image-2021100820174197"></p><p>后端每隔一秒钟推送的数据都可以展现到浏览器上，而右上角显示请求一直在等待中，说明 <code>HTTP</code> 连接一直都未断开。</p><p>接下来，我们简单的实现一下前端的信息展示：</p><p>首先在 <code>create</code> 的时候，我们请求一下 <code>SSE</code> 请求：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code><span class="token function">createSSE</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sseSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">&#39;http://127.0.0.1:3001/getServerMessage&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sseSource<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>computeData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token comment">// 将使用率存入数组，做表格展示使用</span>
        <span class="token keyword">let</span> newDate <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;:&#39;</span> <span class="token operator">+</span> date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;:&#39;</span> <span class="token operator">+</span> date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>usageList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>newDate<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>computeData<span class="token punctuation">.</span>usageRate<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token comment">// 刷新图标</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>charts<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            series<span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    data<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>usageList
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p>需要注意的是，此时我们连接请求是会失败的，因为跨域了，所以我们要在后端加上允许跨域代码（index.js）：</p><div class="language-javascript ext-js line-numbers-mode"><pre class="language-javascript"><code>app<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span><span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Origin&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Headers&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;X-Requested-With&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Access-Control-Allow-Methods&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;PUT,POST,GET,DELETE,OPTIONS&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;X-Powered-By&quot;</span><span class="token punctuation">,</span><span class="token string">&#39; 3.2.1&#39;</span><span class="token punctuation">)</span>
  res<span class="token punctuation">.</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string">&quot;Content-Type&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;application/json;charset=utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>接下来便是界面的展示，在这里就不多赘述，直接上代码：</p><div class="language-vue ext-vue line-numbers-mode"><pre class="language-vue"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>sse-container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>memory-message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message-body<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in computeList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{ item.name }}: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{ computeData[item.key] }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>memory-message<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>message-body<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item in resourceList<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{ item.name }}: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.key !== <span class="token punctuation">&#39;</span>usageRate<span class="token punctuation">&#39;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{ computeData[item.key] | transformMemory }} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> {{ computeData[item.key] }}% <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>map<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> echarts <span class="token keyword">from</span> <span class="token string">&#39;echarts&#39;</span>

<span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token punctuation">{</span>
    text<span class="token operator">:</span> <span class="token string">&#39;内存使用率&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  tooltip<span class="token operator">:</span> <span class="token punctuation">{</span>
    trigger<span class="token operator">:</span> <span class="token string">&#39;axis&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  xAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;时间&#39;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&#39;category&#39;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  yAxis<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;使用率(%)&#39;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&#39;value&#39;</span><span class="token punctuation">,</span>
    <span class="token function-variable function">max</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>max <span class="token operator">+</span> <span class="token number">0.01</span> <span class="token operator">*</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">min</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>min <span class="token operator">-</span> <span class="token number">0.01</span> <span class="token operator">*</span> <span class="token punctuation">(</span>value<span class="token punctuation">.</span>min<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    minInterval<span class="token operator">:</span> <span class="token number">0.5</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  series<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">&#39;使用率&#39;</span><span class="token punctuation">,</span>
    type<span class="token operator">:</span> <span class="token string">&#39;line&#39;</span><span class="token punctuation">,</span> <span class="token comment">// 图类型</span>
    data<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    smooth<span class="token operator">:</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token string">&#39;SSE&#39;</span><span class="token punctuation">,</span>
  filters<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">transformMemory</span> <span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> memoryList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">&#39;B&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;KB&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;MB&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;GB&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;TB&#39;</span><span class="token punctuation">]</span>
      <span class="token keyword">let</span> memory <span class="token operator">=</span> value
      <span class="token keyword">let</span> memoryStr <span class="token operator">=</span> <span class="token string">&#39;&#39;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> memoryList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">let</span> item <span class="token operator">=</span> memoryList<span class="token punctuation">[</span>index<span class="token punctuation">]</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>memory <span class="token operator">&gt;</span> <span class="token number">1024</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            memory <span class="token operator">=</span> memory <span class="token operator">/</span> <span class="token number">1024</span>
            memory <span class="token operator">=</span> memory<span class="token punctuation">.</span><span class="token function">toFixed</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>
            <span class="token keyword">continue</span>
          <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            memoryStr <span class="token operator">=</span> memory <span class="token operator">+</span> item
            <span class="token keyword">break</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> memoryStr
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&#39;--&#39;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">data</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      sseSource<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      computeData<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      resourceList<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">闲置内存</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;free&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">使用内存</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;used&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">内存总量</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;total&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">内存使用率</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;usageRate&#39;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      computeList<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&#39;系统平台&#39;</span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;platform&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&#39;系统正常运行时间（S）&#39;</span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;runTime&#39;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
          name<span class="token operator">:</span> <span class="token string">&#39;用户名&#39;</span><span class="token punctuation">,</span>
          key<span class="token operator">:</span> <span class="token string">&#39;username&#39;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">]</span><span class="token punctuation">,</span>
      charts<span class="token operator">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
      usageList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createSSE</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createChars</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  methods<span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token function">createSSE</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>sseSource <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">EventSource</span><span class="token punctuation">(</span><span class="token string">&#39;http://127.0.0.1:3001/getServerMessage&#39;</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>sseSource<span class="token punctuation">.</span><span class="token function-variable function">onmessage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>computeData <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
        <span class="token keyword">let</span> date <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">let</span> newDate <span class="token operator">=</span> date<span class="token punctuation">.</span><span class="token function">getHours</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;:&#39;</span> <span class="token operator">+</span> date<span class="token punctuation">.</span><span class="token function">getMinutes</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&#39;:&#39;</span> <span class="token operator">+</span> date<span class="token punctuation">.</span><span class="token function">getSeconds</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>usageList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">[</span>newDate<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>computeData<span class="token punctuation">.</span>usageRate<span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>charts<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          series<span class="token operator">:</span> <span class="token punctuation">[</span>
            <span class="token punctuation">{</span>
              data<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>usageList
            <span class="token punctuation">}</span>
          <span class="token punctuation">]</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function">createChars</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>charts <span class="token operator">=</span> echarts<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">&#39;map&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>charts<span class="token punctuation">.</span><span class="token function">setOption</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">beforeDestroy</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>sseSource<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span> <span class="token attr-name">scoped</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>less<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token style"><span class="token language-css">
<span class="token selector">.sse-container</span> <span class="token punctuation">{</span>
  <span class="token selector">.memory-message</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 70%<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
    <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
    <span class="token selector">.message-head, .message-body</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
      <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
      <span class="token selector">.title</span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 40%<span class="token punctuation">;</span>
        <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token selector">.content</span> <span class="token punctuation">{</span>
        <span class="token property">display</span><span class="token punctuation">:</span> inline-block<span class="token punctuation">;</span>
        <span class="token property">margin-left</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
        <span class="token property">width</span><span class="token punctuation">:</span> 30%<span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.map</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 800px<span class="token punctuation">;</span>
    <span class="token property">margin</span><span class="token punctuation">:</span> 0 auto<span class="token punctuation">;</span>
    <span class="token property">margin-top</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br><span class="line-number">175</span><br><span class="line-number">176</span><br><span class="line-number">177</span><br><span class="line-number">178</span><br><span class="line-number">179</span><br></div></div><p>最后我们看到的界面如下图所示：</p><p><img src="https://i.loli.net/2021/10/13/KnBOuFTW4YwxzNf.png" alt="image-2021100820470104"></p><h2 id="结论" tabindex="-1"><a class="header-anchor" href="#结论" aria-hidden="true">#</a> 结论</h2><p>对于连接方式，<code>WebSoket</code> 是基于 <code>TCP</code> 协议的连接，与 <code>HTTP</code> 协议有着良好的兼容性，没有同源限制，且为双向通信，所以我们可以在很多偏向实时的、双向的频繁操作的情况下使用 <code>WebSoket</code> 例如监控视频播放插件中，我们可以使用它进行实时的操作，保证请求及反馈的实时性。而 <code>SSE</code> 相对比，显得更轻量，我们不需要另外开辟一个端口去实现，基于其单向交互的特性，我们可以用它来实现一些性能监控或状态实时获取等业务场景（<code>Vue</code> 热更新也是使用 <code>SSE</code> 做到代码更新的实时推送的）。简单来说， <code>WebSoket</code> 适合复杂的前后端实时且频繁交互，使用范围广但相较于 <code>SSE</code> 则偏重量级； <code>SSE</code> 则更适合一些简单的后端状态获取，但实现更为轻量；</p><p>最后则是两个技术都要注意的一点：<strong>连接限制</strong></p><p>对于 <code>WebSoket</code> ，各个浏览器限制为（此限制似乎只限于原生连接，如果使用 <code>soket.io</code> 似乎没有限制了 ）：</p><table><thead><tr><th>浏览器</th><th>限制</th></tr></thead><tbody><tr><td>IE（IE9以下不支持）</td><td>6</td></tr><tr><td>chrome</td><td>6</td></tr><tr><td>firefox</td><td>6</td></tr><tr><td>Safari</td><td>5</td></tr></tbody></table><p>对于 <code>SSE</code> ,各浏览器限制为：</p><table><thead><tr><th>浏览器</th><th>限制</th></tr></thead><tbody><tr><td>IE11</td><td>13</td></tr><tr><td>Chrome</td><td>6</td></tr><tr><td>火狐</td><td>6</td></tr><tr><td>Safari</td><td>6</td></tr></tbody></table><p>上述两个实例已上传到我的 <code>git</code> 上，大家可自取使用，地址为：</p><p>前端：https://github.com/shiyingjieGra/websoketWeb</p><p>后端：https://github.com/shiyingjieGra/websoketNode</p><p>本篇内容参考文档有：</p><p>[WebSocket入门教程（三）-- WebSocket实例：实时获取服务器内存使用情况](WebSocket入门教程（三）-- WebSocket实例：实时获取服务器内存使用情况)</p><p><a href="https://blog.csdn.net/u010136741/article/details/51612594?spm=1001.2014.3001.5501" target="_blank" rel="noopener noreferrer">WebSocket入门教程（五）-- WebSocket实例：简单多人聊天室<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><p><a href="https://my.oschina.net/shisl/blog/4773984" target="_blank" rel="noopener noreferrer">Browser connection limitations（浏览器长连接个数限制）解决方案<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a></p><!--]--></div><footer class="page-meta"><!----><div class="meta-item last-updated"><span class="meta-item-label">Last Updated: </span><span class="meta-item-info">12/6/2021, 4:50:46 PM</span></div><div class="meta-item contributors"><span class="meta-item-label">Contributors: </span><span class="meta-item-info"><!--[--><!--[--><span class="contributor" title="email: zhanghongan2021@163.com">zhanghongan</span><!----><!--]--><!--]--></span></div></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script src="/assets/js/runtime~app.892bb2af.js" defer></script><script src="/assets/js/812.9e9966eb.js" defer></script><script src="/assets/js/app.59477691.js" defer></script>
  </body>
</html>
